{"version":3,"sources":["../../src/query/query.router.ts"],"sourcesContent":["import { Input, Query, Router } from 'nestjs-trpc';\nimport { z } from 'zod';\nimport { Inject } from '@nestjs/common';\nimport { sql } from 'kysely';\n\nimport { QueryService } from './query.service';\n\nimport { Database } from '~/database/database';\n\n@Router({ alias: 'query' })\nexport class QueryRouter {\n  constructor(\n    @Inject(QueryService) private queryService: QueryService,\n    @Inject(Database) private readonly database: Database\n  ) {}\n\n  @Query({\n    input: z.object({ query: z.string() }),\n    output: z.any(),\n  })\n  async execute(@Input('query') query: string) {\n    return this.queryService.execute({\n      query: sql.raw(query).compile(this.database),\n    });\n  }\n}\n"],"names":["Input","Query","Router","z","Inject","sql","QueryService","Database","QueryRouter","constructor","queryService","database","execute","query","raw","compile","input","object","string","output","any","alias"],"mappings":";;;;;;;;;;;;;;AAAA,SAASA,KAAK,EAAEC,KAAK,EAAEC,MAAM,QAAQ,cAAc;AACnD,SAASC,CAAC,QAAQ,MAAM;AACxB,SAASC,MAAM,QAAQ,iBAAiB;AACxC,SAASC,GAAG,QAAQ,SAAS;AAE7B,SAASC,YAAY,QAAQ,qBAAkB;AAE/C,SAASC,QAAQ,QAAQ,0BAAsB;AAG/C,OAAO,MAAMC;IACXC,YACE,AAA8BC,YAA0B,EACxD,AAAmCC,QAAkB,CACrD;aAF8BD,eAAAA;aACKC,WAAAA;IAClC;IAEH,MAIMC,QAAQ,AAAgBC,KAAa,EAAE;QAC3C,OAAO,IAAI,CAACH,YAAY,CAACE,OAAO,CAAC;YAC/BC,OAAOR,IAAIS,GAAG,CAACD,OAAOE,OAAO,CAAC,IAAI,CAACJ,QAAQ;QAC7C;IACF;AACF;;;QARIK,OAAOb,EAAEc,MAAM,CAAC;YAAEJ,OAAOV,EAAEe,MAAM;QAAG;QACpCC,QAAQhB,EAAEiB,GAAG;;;;;;;;;;;QATPC,OAAO"}