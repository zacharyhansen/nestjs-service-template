{"version":3,"sources":["../../src/dataset/dataset.router.ts"],"sourcesContent":["import { Input, Mutation, Query, Router, Ctx } from 'nestjs-trpc';\nimport { z } from 'zod';\nimport { Inject } from '@nestjs/common';\n\nimport {\n  DatasetOutputSchema,\n  RootDataViewInputSchema,\n  type RootDataViewInput,\n} from './dataset.types';\nimport { DatasetService } from './dataset.service';\n\nimport type { AppTrpcContext, ClerkClaims } from '~/auth/types';\nimport type { AppContext } from '~/auth/trpc/clerk-context';\n\n@Router({ alias: 'dataset' })\nexport class DatasetRouter {\n  constructor(@Inject(DatasetService) private datasetService: DatasetService) {}\n\n  @Query({\n    input: z.object({\n      datasetId: z.string(),\n    }),\n    output: DatasetOutputSchema,\n  })\n  dataset(@Input('datasetId') datasetId: string) {\n    return this.datasetService.dataset({ datasetId });\n  }\n\n  @Mutation({\n    input: z.object({\n      rootDataview: RootDataViewInputSchema,\n    }),\n    output: DatasetOutputSchema,\n  })\n  async insertRootDataview(\n    @Ctx() context: AppTrpcContext,\n    @Input('rootDataview') rootDataview: RootDataViewInput\n  ) {\n    return this.datasetService.insertRootDataview({\n      rootDataview,\n      userId: context.clerkclaims.sub,\n      schema: context.clerkclaims.environment,\n    });\n  }\n}\n"],"names":["Input","Mutation","Query","Router","Ctx","z","Inject","DatasetOutputSchema","RootDataViewInputSchema","DatasetService","DatasetRouter","constructor","datasetService","dataset","datasetId","insertRootDataview","context","rootDataview","userId","clerkclaims","sub","schema","environment","input","object","string","output","alias"],"mappings":";;;;;;;;;;;;;;AAAA,SAASA,KAAK,EAAEC,QAAQ,EAAEC,KAAK,EAAEC,MAAM,EAAEC,GAAG,QAAQ,cAAc;AAClE,SAASC,CAAC,QAAQ,MAAM;AACxB,SAASC,MAAM,QAAQ,iBAAiB;AAExC,SACEC,mBAAmB,EACnBC,uBAAuB,QAElB,qBAAkB;AACzB,SAASC,cAAc,QAAQ,uBAAoB;AAMnD,OAAO,MAAMC;IACXC,YAAY,AAAgCC,cAA8B,CAAE;aAAhCA,iBAAAA;IAAiC;IAQ7EC,QAAQ,AAAoBC,SAAiB,EAAE;QAC7C,OAAO,IAAI,CAACF,cAAc,CAACC,OAAO,CAAC;YAAEC;QAAU;IACjD;IAEA,MAMMC,mBACJ,AAAOC,OAAuB,EAC9B,AAAuBC,YAA+B,EACtD;QACA,OAAO,IAAI,CAACL,cAAc,CAACG,kBAAkB,CAAC;YAC5CE;YACAC,QAAQF,QAAQG,WAAW,CAACC,GAAG;YAC/BC,QAAQL,QAAQG,WAAW,CAACG,WAAW;QACzC;IACF;AACF;;;QAzBIC,OAAOlB,EAAEmB,MAAM,CAAC;YACdV,WAAWT,EAAEoB,MAAM;QACrB;QACAC,QAAQnB;;;;;;;;;;;QAORgB,OAAOlB,EAAEmB,MAAM,CAAC;YACdP,cAAcT;QAChB;QACAkB,QAAQnB;;;;;;;;;;;;;QAlBFoB,OAAO"}